<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>Gent Bros</title>
  <link rel="icon" type="image/png" href="../logos/favicon_W.png">

  <!-- Your CSS files (unchanged) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="CSS/colors.css">
  <link rel="stylesheet" href="CSS/debug overlay.css">  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50 font-sans">

  <!-- Top Bar -->
  <header class="text-white py-4 px-6" style="background: var(--primary-color)">

  <div onclick="window.location.href='index.html'">
    <div>
      <span class="text-lg font-semibold"><img src="logos/logo_w.svg" alt="Logo"></span>
    </div>
  </div>

  </header>

  <!-- Cart Layout -->
  <main class="max-w-6xl mx-auto py-12 px-4 lg:px-8 grid lg:grid-cols-3 gap-10">
    
    <!-- Cart Items -->
    <div class="lg:col-span-2 space-y-6">
      <h2 class="text-3xl font-bold text-gray-900 mb-4">Your Cart</h2>
      <div id="cartContainer" class="space-y-6"></div>
    </div>
    
    <!-- Order Summary -->
    <div>
      <div class="bg-white rounded-2xl shadow-lg p-8 sticky top-8">
        <h2 class="text-xl font-bold text-gray-900 mb-6">Order Summary</h2>
        
        <div class="flex justify-between mb-3 text-gray-600">
          <span>Subtotal</span>
          <span id="subtotal">à§³0.00</span>
        </div>
        <div class="flex justify-between mb-3 text-gray-600">
          <span>Shipping</span>
          <span id="shipping">à§³0.00</span>
        </div>
        <div class="flex justify-between border-t pt-4 text-lg font-semibold text-gray-900">
          <span>Total</span>
          <span id="cartTotal">à§³0.00</span>
        </div>
        
        <button class="mt-6 w-full text-white py-3 rounded-xl font-medium" 
                style="background: var(--primary-color)"
                onmouseover="this.style.background= 'var(--primary-hover-color)'"
                onmouseout="this.style.background= 'var(--primary-color)'"
                onclick="window.location.href='checkout.html'">
          Proceed to Checkout
        </button>

        
    <div class="mt-6">
      <h3 class="text-sm font-medium text-gray-700 mb-2">Delivery</h3>
    <label class="flex items-center space-x-2">
      <input type="checkbox" id="outsideDelivery" class="text-black">
      <span id="outsideLabel" class="text-red-600 font-semibold">Outside Dhaka</span>
    </label>
    <p id="insideLabel" class="text-xs text-gray-500 mt-1"></p>
    
    </div>



        <p class="text-sm text-gray-500 mt-4 text-center">ðŸšš Cash on delivery</p>
      </div>
    </div>
  </main>









   <!-- GIF Animation -->
   <div id="bottomGifContainer"></div>
   
   <style>
  #bottomGifContainer {
    position: fixed;
    bottom: 0;
    left: 0;
    z-index: 9999;
    display: flex;
    gap: 10px; /* spacing between multiple GIFs */
  }
  #bottomGifContainer img {
    width: var(--gif-width, 150px);
    height: var(--gif-height, auto);
    object-fit: contain;
    pointer-events: none;
    user-select: none;
    opacity: 0;
    transition: opacity 0.35s ease;
  }
   </style>
   
   <script>
document.addEventListener("DOMContentLoaded", function () {
  const container = document.getElementById("bottomGifContainer");
  if (!container) return;

  const GIF8 = "gif/gif8.gif";  // cart has product sequence
  const GIF9 = "gif/gif9.gif";  // looping GIF for cart
  const GIF10 = "gif/gif10.gif"; // empty cart sequence 1
  const GIF11 = "gif/gif11.gif"; // empty cart sequence 2

  // Preload GIFs
  [GIF8, GIF9, GIF10, GIF11].forEach(src => { const i = new Image(); i.src = src; });

  const delay = ms => new Promise(resolve => setTimeout(resolve, ms));

  function clearContainer() {
    while (container.firstChild) container.removeChild(container.firstChild);
  }

  let gifRunId = 0; // track runs to cancel previous loops

  function showGifElementAsync(src, duration = Infinity, runId) {
    return new Promise(resolve => {
      if (runId !== gifRunId) {
        clearContainer();
        return resolve();
      }

      clearContainer();
      const img = document.createElement("img");
      img.src = src;
      img.style.opacity = 0;
      img.style.transition = "opacity 0.35s ease";
      img.alt = "Animated sequence";
      container.appendChild(img);

      requestAnimationFrame(() => {
        if (runId === gifRunId) img.style.opacity = 1;
      });

      if (duration === Infinity) return;

      const timeoutId = setTimeout(() => {
        if (runId !== gifRunId) {
          if (container.contains(img)) container.removeChild(img);
          return resolve();
        }
        img.style.opacity = 0;
        setTimeout(() => {
          if (runId !== gifRunId) {
            if (container.contains(img)) container.removeChild(img);
            return resolve();
          }
          if (container.contains(img)) container.removeChild(img);
          resolve();
        }, 350);
      }, duration);

      const cancelPoll = setInterval(() => {
        if (runId !== gifRunId) {
          clearInterval(cancelPoll);
          clearTimeout(timeoutId);
          if (container.contains(img)) container.removeChild(img);
          return resolve();
        }
      }, 150);
    });
  }

  function getCartSafely() {
    try {
      return (window.CartUtils && CartUtils.getCart && CartUtils.getCart()) || [];
    } catch {
      return [];
    }
  }

  async function startGifLogic() {
    const myRun = ++gifRunId;
    const cart = getCartSafely();
    const hasItems = cart.some(item => (item.quantity || 0) > 0);

    if (!hasItems) {
      // Empty cart â†’ show GIF10 for 10s then GIF11 for 10s
      await showGifElementAsync(GIF10, 10000, myRun);
      if (myRun !== gifRunId) return;
      await showGifElementAsync(GIF11, 10000, myRun);
      return;
    }

    // Cart has products â†’ run sequence GIF8 â†’ wait 5s â†’ GIF9 indefinitely
    await delay(1000);
    if (myRun !== gifRunId) return;

    // Show GIF8 for 5s
    await showGifElementAsync(GIF8, 5000, myRun);
    if (myRun !== gifRunId) return;

    // Wait 5s
    await delay(5000);
    if (myRun !== gifRunId) return;

    // Show GIF9 indefinitely
    await showGifElementAsync(GIF9, Infinity, myRun);
  }

  // Expose globally
  window.startGifLogic = startGifLogic;

  // Listen to cart updates
  window.addEventListener('cart:updated', () => startGifLogic());

  // Start automatically
  startGifLogic();
});
   </script>







  <!-- Debug Overlay -->
   <!-- <button id="clearCartBtn">Clear Cart (Test)</button>
   <div id="cartDebugPanel"></div> -->


   <script src="JS/cart-utils.js" defer></script>
   <script src="JS/cart.js" defer></script>
</body>
</html>



